***************
*** 1792,1805 ****
              _ ->
                  ok
          end,
-         timer:sleep(1100),
          
          %% A delete, an update and an insert
          ok = delete(B, <<"k">>),
          ok = put(B, <<"k2">>, <<"v2-2">>),
          ok = put(B, <<"k4">>, <<"v4">>),
       
-         timer:sleep(1100),
          CollectAll = fun(K, V, Acc) ->
                               [{K, V} | Acc]
                       end,
--- 1802,1820 ----
              _ ->
                  ok
          end,
+         receive
+             i_have_started_folding ->
+                 ok
+         after 10*1000 ->
+                 error(timeout_should_never_happen)
+         end,
          
          %% A delete, an update and an insert
          ok = delete(B, <<"k">>),
          ok = put(B, <<"k2">>, <<"v2-2">>),
          ok = put(B, <<"k4">>, <<"v4">>),
+         Pid ! go_ahead_with_fold,
       
          CollectAll = fun(K, V, Acc) ->
                               [{K, V} | Acc]
                       end,
