%% -------------------------------------------------------------------
%%
%% Copyright (c) 2010-2015 Basho Technologies, Inc.
%%
%% This file is provided to you under the Apache License,
%% Version 2.0 (the "License"); you may not use this file
%% except in compliance with the License.  You may obtain
%% a copy of the License at
%%
%%   http://www.apache.org/licenses/LICENSE-2.0
%%
%% Unless required by applicable law or agreed to in writing,
%% software distributed under the License is distributed on an
%% "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
%% KIND, either express or implied.  See the License for the
%% specific language governing permissions and limitations
%% under the License.
%%
%% -------------------------------------------------------------------

{erl_opts, [
    debug_info,
    warn_untyped_record,
    warnings_as_errors,
    {platform_define, "^R[1-9]", no_otp_namespaced_types}
]}.

{deps, [
    {cuttlefish, ".*", {git, "git://github.com/basho/cuttlefish.git", {branch, "feature/otp-17"}}},
    {meck, ".*", {git, "git://github.com/basho/meck.git", {branch, "feature/otp-17"}}},
    {otp_compat, ".*", {git, "git://github.com/tburghart/otp_compat.git", {branch, "master"}}}
]}.

{port_specs, [{"priv/bitcask.so", ["c_src/*.c"]}]}.

{port_env, [
    {"DRV_CFLAGS", "-g -Wall -fPIC $ERL_CFLAGS"},

    %% Solaris specific flags
    {"solaris.*-64$", "CFLAGS", "-D_REENTRANT -m64"},
    {"solaris.*-64$", "LDFLAGS", "-m64"},

    %% OS X Leopard flags for 64-bit
    {"darwin9.*-64$", "CFLAGS", "-m64"},
    {"darwin9.*-64$", "LDFLAGS", "-arch x86_64"},

    %% OS X Snow Leopard flags for 32-bit
    {"darwin10.*-32$", "CFLAGS", "-m32"},
    {"darwin10.*-32$", "LDFLAGS", "-arch i386"}
]}.

{eunit_opts, [verbose]}.

{xref_checks, [undefined_function_calls]}.
